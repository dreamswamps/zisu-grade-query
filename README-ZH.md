# ZISU GPA自动查询统计脚本

> 一个基于Python的自动化工具，针对浙江外国语学院教务系统，用于查询和统计学业成绩及GPA和综测成绩。

## ✨ 功能描述

### [√] 已完成功能
- **数据抓取** 抓取并解析指定学年的成绩数据
- **统计计算** 统计必修/选修课程的学分、绩点，计算学年GPA
- **结果展示** 在控制台输出统计报告
### [ ] 规划中功能
- **会话自动管理** ：自动获取/刷新教务系统会话信息和用户认证(Cookie/Headers)

## 🚀 快速开始

### 环境要求

- Python 3.8+
- 依赖库：`requests`

### 安装与运行

1. 克隆项目：
    ```bash
    git clone https://github.com/dreamswamps/zisu-grade-query.git
    cd zisu-grade-query
    ```

2. 安装依赖：
    ```bash
    pip install requests
    ```

3. 配置信息：
    运行前，请根据下方 **[使用说明](#configuration)** 配置参数。

4. 运行脚本
    ```bash
    python ZISU.py
    ```

## 📖 使用说明 <a id="configuration"></a>

1. 信息配置：
    对选择的脚本手动配置身份验证信息：
    - **ZISU.py** :
        ```python
        gnmkdm = "查询编号字段"  # 来自网址路径
        cookie = "用户认证"
        years = ["2022","2023"]
        ```
    - **ZISU_GPA.py** :
        配置项与 `ZISU.py` 类似。
    - **ZISU_ZC.py** :
        ```python
        headers = {
            'Authorization': '',
            'Blade-Auth': ''
            }  # 来自开发者工具的网络请求
        years = ["2022","2023"]
        ```

    >**ℹ️ 提示**：如何获得参数？使用浏览器开发者工具（F12），在登陆后查看访问成绩页面时的网络请求，获取对应的Cookie或Header信息。

2. 保存后运行脚本，等待并查看终端输出的统计结果。

## 📁 项目结构

```
zisu-grade-query/
├── ZISU.py         # 基础脚本：指定学年GPA统计
├── ZISU_GPA.py     # 增强功能：全部课程GPA统计
└── ZISU_ZC.py      # 改进功能：综测分统计
```

## ❓ 常见问题

**Q: 运行脚本后报错，或脚本无反应？**

**A:** 请按照以下步骤进行排查：
1. **认证信息过期**：Cookie或Header信息有约一天的有效期，请尝试重新登陆并获取新的认证信息。
2. **系统维护**：校教务系统可能在每日7:00 - 22:00外的时间进行维护，请在此时间段使用。
3. **网络问题**：请检查网络连接是否正常。
4. **特殊情况**：若正值选课等特殊时期，校教务系统可能因过大请求访问而面临崩溃风险，此情况请绝对不要使用。